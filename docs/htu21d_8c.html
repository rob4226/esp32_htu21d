<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>esp32_htu21d IDF Component: htu21d.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="htu21d-doxygen-pic-200x55px.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">esp32_htu21d IDF Component
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">An ESP-IDF component to interface with the HTU21D humidity/temperature sensor on the I2C bus.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('htu21d_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">htu21d.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>HTU21D Sensor ESP-IDF Component source code file.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;esp_log.h&quot;</code><br />
<code>#include &quot;<a class="el" href="htu21d_8h_source.html">htu21d.h</a>&quot;</code><br />
</div>
<p><a href="htu21d_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ac1b78d35a052811edfebff2d5a6d0ac3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htu21d_8c.html#ac1b78d35a052811edfebff2d5a6d0ac3">HTU21_TEMPERATURE_COEFFICIENT</a>&#160;&#160;&#160;(-0.15F)</td></tr>
<tr class="memdesc:ac1b78d35a052811edfebff2d5a6d0ac3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used in equation to convert Measured Relative Humidity to Temperature Compensated Relative Humidity.  <a href="htu21d_8c.html#ac1b78d35a052811edfebff2d5a6d0ac3">More...</a><br /></td></tr>
<tr class="separator:ac1b78d35a052811edfebff2d5a6d0ac3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a837f184fd5f7cd215a73fde29517e680"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htu21d_8c.html#a837f184fd5f7cd215a73fde29517e680">HTU21_CONSTANT_A</a>&#160;&#160;&#160;(8.1332F)</td></tr>
<tr class="memdesc:a837f184fd5f7cd215a73fde29517e680"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constant <code>A</code> used in Partial Pressure from Ambient Temperature formula.  <a href="htu21d_8c.html#a837f184fd5f7cd215a73fde29517e680">More...</a><br /></td></tr>
<tr class="separator:a837f184fd5f7cd215a73fde29517e680"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ab0f7858e0ae95aaeda107dc97b37fa"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htu21d_8c.html#a9ab0f7858e0ae95aaeda107dc97b37fa">HTU21_CONSTANT_B</a>&#160;&#160;&#160;(1762.39F)</td></tr>
<tr class="memdesc:a9ab0f7858e0ae95aaeda107dc97b37fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constant <code>B</code> used in Partial Pressure from Ambient Temperature formula.  <a href="htu21d_8c.html#a9ab0f7858e0ae95aaeda107dc97b37fa">More...</a><br /></td></tr>
<tr class="separator:a9ab0f7858e0ae95aaeda107dc97b37fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5e26d52ff76908c4b22baeebe83d017"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htu21d_8c.html#aa5e26d52ff76908c4b22baeebe83d017">HTU21_CONSTANT_C</a>&#160;&#160;&#160;(235.66F)</td></tr>
<tr class="memdesc:aa5e26d52ff76908c4b22baeebe83d017"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constant <code>C</code> used in Partial Pressure from Ambient Temperature formula.  <a href="htu21d_8c.html#aa5e26d52ff76908c4b22baeebe83d017">More...</a><br /></td></tr>
<tr class="separator:aa5e26d52ff76908c4b22baeebe83d017"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad051dbd53437a44c5d767b481a2c3f86"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htu21d_8c.html#ad051dbd53437a44c5d767b481a2c3f86">htu21d_init</a> (i2c_port_t port, int sda_pin, int scl_pin, gpio_pullup_t sda_internal_pullup, gpio_pullup_t scl_internal_pullup)</td></tr>
<tr class="memdesc:ad051dbd53437a44c5d767b481a2c3f86"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the HTU21D temperature/humidity sensor and the I2C bus.  <a href="htu21d_8c.html#ad051dbd53437a44c5d767b481a2c3f86">More...</a><br /></td></tr>
<tr class="separator:ad051dbd53437a44c5d767b481a2c3f86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81b12a55ffcd34e96c8fce5028b180b3"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htu21d_8c.html#a81b12a55ffcd34e96c8fce5028b180b3">htu21d_read_temperature</a> ()</td></tr>
<tr class="memdesc:a81b12a55ffcd34e96c8fce5028b180b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the temperature from the HTU21D sensor.  <a href="htu21d_8c.html#a81b12a55ffcd34e96c8fce5028b180b3">More...</a><br /></td></tr>
<tr class="separator:a81b12a55ffcd34e96c8fce5028b180b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a22e7b10c2373f78b6933a55bd8ff43"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htu21d_8c.html#a6a22e7b10c2373f78b6933a55bd8ff43">htu21d_read_humidity</a> ()</td></tr>
<tr class="memdesc:a6a22e7b10c2373f78b6933a55bd8ff43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the relative humidity from the HTU21D sensor.  <a href="htu21d_8c.html#a6a22e7b10c2373f78b6933a55bd8ff43">More...</a><br /></td></tr>
<tr class="separator:a6a22e7b10c2373f78b6933a55bd8ff43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e60229c5b94700ed68974681822f9e2"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htu21d_8c.html#a2e60229c5b94700ed68974681822f9e2">htu21d_compute_partial_pressure</a> (float temperature)</td></tr>
<tr class="memdesc:a2e60229c5b94700ed68974681822f9e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the Partial Pressure at ambient temperature, by using the ambient temperature read from the HTU21D sensor.  <a href="htu21d_8c.html#a2e60229c5b94700ed68974681822f9e2">More...</a><br /></td></tr>
<tr class="separator:a2e60229c5b94700ed68974681822f9e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c7853a065367238e99ee63f2bc337eb"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htu21d_8c.html#a6c7853a065367238e99ee63f2bc337eb">htu21d_compute_dew_point</a> (float temperature, float relative_humidity)</td></tr>
<tr class="memdesc:a6c7853a065367238e99ee63f2bc337eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the Dew Point.  <a href="htu21d_8c.html#a6c7853a065367238e99ee63f2bc337eb">More...</a><br /></td></tr>
<tr class="separator:a6c7853a065367238e99ee63f2bc337eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fa5f607e157a9212f40c0ed3188fc70"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htu21d_8c.html#a9fa5f607e157a9212f40c0ed3188fc70">htu21d_get_resolution</a> ()</td></tr>
<tr class="separator:a9fa5f607e157a9212f40c0ed3188fc70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a435949c4c13de07e37ee0775279f05ca"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htu21d_8c.html#a435949c4c13de07e37ee0775279f05ca">htu21d_set_resolution</a> (uint8_t resolution)</td></tr>
<tr class="separator:a435949c4c13de07e37ee0775279f05ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa3123a7b394609dbe9b1353f7f39211"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htu21d_8c.html#aaa3123a7b394609dbe9b1353f7f39211">htu21d_soft_reset</a> ()</td></tr>
<tr class="separator:aaa3123a7b394609dbe9b1353f7f39211"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa715a7b21d0b58494f0c882e528f6aea"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htu21d_8c.html#aa715a7b21d0b58494f0c882e528f6aea">htu21d_read_user_register</a> ()</td></tr>
<tr class="separator:aa715a7b21d0b58494f0c882e528f6aea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d2e44ed88189e54d38d5b67c992cd26"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htu21d_8c.html#a0d2e44ed88189e54d38d5b67c992cd26">htu21d_write_user_register</a> (uint8_t value)</td></tr>
<tr class="separator:a0d2e44ed88189e54d38d5b67c992cd26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae2cded128546fee5cc5cd9d0d1092ab"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htu21d_8c.html#aae2cded128546fee5cc5cd9d0d1092ab">read_value</a> (uint8_t command)</td></tr>
<tr class="separator:aae2cded128546fee5cc5cd9d0d1092ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59a8faa300ba356f970ca9e961381ac2"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htu21d_8c.html#a59a8faa300ba356f970ca9e961381ac2">is_crc_valid</a> (uint16_t value, uint8_t crc)</td></tr>
<tr class="separator:a59a8faa300ba356f970ca9e961381ac2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c3cfdb690aad2dea107788bb2fdbf3d"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htu21d_8c.html#a2c3cfdb690aad2dea107788bb2fdbf3d">celsius_to_fahrenheit</a> (float celsius_degrees)</td></tr>
<tr class="memdesc:a2c3cfdb690aad2dea107788bb2fdbf3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts Celsius to Fahrenheit.  <a href="htu21d_8c.html#a2c3cfdb690aad2dea107788bb2fdbf3d">More...</a><br /></td></tr>
<tr class="separator:a2c3cfdb690aad2dea107788bb2fdbf3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d814d0d12bf79f01257b7f50321b116"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htu21d_8c.html#a2d814d0d12bf79f01257b7f50321b116">htu21_compute_compensated_humidity</a> (float temperature, float relative_humidity)</td></tr>
<tr class="memdesc:a2d814d0d12bf79f01257b7f50321b116"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the temperature compensated humidity.  <a href="htu21d_8c.html#a2d814d0d12bf79f01257b7f50321b116">More...</a><br /></td></tr>
<tr class="separator:a2d814d0d12bf79f01257b7f50321b116"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>HTU21D Sensor ESP-IDF Component source code file. </p>
<p>ESP-IDF component to interface with the HTU21D humidity and temperature sensor by TE Connectivity (<a href="http://www.te.com/usa-en/product-CAT-HSC0004.html">http://www.te.com/usa-en/product-CAT-HSC0004.html</a>).</p>
<dl class="section author"><dt>Author</dt><dd>Luca Dentella, www.lucadentella.it </dd>
<dd>
rob4226 <a href="#" onclick="location.href='mai'+'lto:'+'rob'+'42'+'26@'+'ya'+'hoo'+'.c'+'om'; return false;">rob42<span style="display: none;">.nosp@m.</span>26@y<span style="display: none;">.nosp@m.</span>ahoo.<span style="display: none;">.nosp@m.</span>com</a> </dd></dl>
<dl class="section date"><dt>Date</dt><dd>10.8.2017, 11.29.2023 </dd></dl>

<p class="definition">Definition in file <a class="el" href="htu21d_8c_source.html">htu21d.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a837f184fd5f7cd215a73fde29517e680"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a837f184fd5f7cd215a73fde29517e680">&#9670;&nbsp;</a></span>HTU21_CONSTANT_A</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTU21_CONSTANT_A&#160;&#160;&#160;(8.1332F)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constant <code>A</code> used in Partial Pressure from Ambient Temperature formula. </p>

<p class="definition">Definition at line <a class="el" href="htu21d_8c_source.html#l00018">18</a> of file <a class="el" href="htu21d_8c_source.html">htu21d.c</a>.</p>

</div>
</div>
<a id="a9ab0f7858e0ae95aaeda107dc97b37fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ab0f7858e0ae95aaeda107dc97b37fa">&#9670;&nbsp;</a></span>HTU21_CONSTANT_B</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTU21_CONSTANT_B&#160;&#160;&#160;(1762.39F)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constant <code>B</code> used in Partial Pressure from Ambient Temperature formula. </p>

<p class="definition">Definition at line <a class="el" href="htu21d_8c_source.html#l00019">19</a> of file <a class="el" href="htu21d_8c_source.html">htu21d.c</a>.</p>

</div>
</div>
<a id="aa5e26d52ff76908c4b22baeebe83d017"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5e26d52ff76908c4b22baeebe83d017">&#9670;&nbsp;</a></span>HTU21_CONSTANT_C</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTU21_CONSTANT_C&#160;&#160;&#160;(235.66F)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constant <code>C</code> used in Partial Pressure from Ambient Temperature formula. </p>

<p class="definition">Definition at line <a class="el" href="htu21d_8c_source.html#l00020">20</a> of file <a class="el" href="htu21d_8c_source.html">htu21d.c</a>.</p>

</div>
</div>
<a id="ac1b78d35a052811edfebff2d5a6d0ac3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1b78d35a052811edfebff2d5a6d0ac3">&#9670;&nbsp;</a></span>HTU21_TEMPERATURE_COEFFICIENT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTU21_TEMPERATURE_COEFFICIENT&#160;&#160;&#160;(-0.15F)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Used in equation to convert Measured Relative Humidity to Temperature Compensated Relative Humidity. </p>

<p class="definition">Definition at line <a class="el" href="htu21d_8c_source.html#l00017">17</a> of file <a class="el" href="htu21d_8c_source.html">htu21d.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a2c3cfdb690aad2dea107788bb2fdbf3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c3cfdb690aad2dea107788bb2fdbf3d">&#9670;&nbsp;</a></span>celsius_to_fahrenheit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float celsius_to_fahrenheit </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>celsius_degrees</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts Celsius to Fahrenheit. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">celsius_degrees</td><td>The temperature in degrees Celsius. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a <code>float</code> in degrees Fahrenheit. </dd></dl>

<p class="definition">Definition at line <a class="el" href="htu21d_8c_source.html#l00407">407</a> of file <a class="el" href="htu21d_8c_source.html">htu21d.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;{</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordflow">return</span> (celsius_degrees * 9.0F / 5.0F) + 32.0F;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2d814d0d12bf79f01257b7f50321b116"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d814d0d12bf79f01257b7f50321b116">&#9670;&nbsp;</a></span>htu21_compute_compensated_humidity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float htu21_compute_compensated_humidity </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>relative_humidity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the temperature compensated humidity. </p>
<p>For temperatures other than 25°C, this function, which applies a temperature coefficient compensation equation, can be used and will guarantee Relative Humidity accuracy within ±2%, from 0°C to 80°C.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">temperature</td><td>Actual temperature measured (degC). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">relative_humidity</td><td>Actual relative humidity measured (RH).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the temperature compensated humidity (RH). </dd></dl>

<p class="definition">Definition at line <a class="el" href="htu21d_8c_source.html#l00424">424</a> of file <a class="el" href="htu21d_8c_source.html">htu21d.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;{</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordflow">return</span> (relative_humidity +</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            (25.0F - temperature) * <a class="code" href="htu21d_8c.html#ac1b78d35a052811edfebff2d5a6d0ac3">HTU21_TEMPERATURE_COEFFICIENT</a>);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;}</div>
<div class="ttc" id="ahtu21d_8c_html_ac1b78d35a052811edfebff2d5a6d0ac3"><div class="ttname"><a href="htu21d_8c.html#ac1b78d35a052811edfebff2d5a6d0ac3">HTU21_TEMPERATURE_COEFFICIENT</a></div><div class="ttdeci">#define HTU21_TEMPERATURE_COEFFICIENT</div><div class="ttdoc">Used in equation to convert Measured Relative Humidity to Temperature Compensated Relative Humidity.</div><div class="ttdef"><b>Definition:</b> <a href="htu21d_8c_source.html#l00017">htu21d.c:17</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6c7853a065367238e99ee63f2bc337eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c7853a065367238e99ee63f2bc337eb">&#9670;&nbsp;</a></span>htu21d_compute_dew_point()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float htu21d_compute_dew_point </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>relative_humidity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the Dew Point. </p>
<p>The dew point is the temperature at which the water vapor in the air becomes saturated and condensation begins.</p>
<p>The dew point is associated with relative humidity. A high relative humidity indicates that the dew point is closer to the current air temperature. Relative humidity of 100% indicates that the dew point is equal to the current temperature (and the air is maximally saturated with water so it cannot hold any more water). When the dew point stays constant and ambient temperature increases, relative humidity decreases.</p>
<p>Dew point temperature of the air is calculated using Ambient Relative Humidity and Temperature measurements from HTU21D sensor. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">temperature</td><td>Actual ambient temperature (degC) measured from sensor. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">relative_humidity</td><td>Actual relative humidity (RH) measured from sensor. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the calculated Dew Point in °C. </dd></dl>

<p class="definition">Definition at line <a class="el" href="htu21d_8c_source.html#l00176">176</a> of file <a class="el" href="htu21d_8c_source.html">htu21d.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;{</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordtype">float</span> partial_pressure = <a class="code" href="htu21d_8c.html#a2e60229c5b94700ed68974681822f9e2">htu21d_compute_partial_pressure</a>(temperature);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">return</span> - <a class="code" href="htu21d_8c.html#a9ab0f7858e0ae95aaeda107dc97b37fa">HTU21_CONSTANT_B</a> /</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;           (log10(relative_humidity * partial_pressure / 100.0F) - <a class="code" href="htu21d_8c.html#a837f184fd5f7cd215a73fde29517e680">HTU21_CONSTANT_A</a>)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;           - <a class="code" href="htu21d_8c.html#aa5e26d52ff76908c4b22baeebe83d017">HTU21_CONSTANT_C</a>;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;}</div>
<div class="ttc" id="ahtu21d_8c_html_a2e60229c5b94700ed68974681822f9e2"><div class="ttname"><a href="htu21d_8c.html#a2e60229c5b94700ed68974681822f9e2">htu21d_compute_partial_pressure</a></div><div class="ttdeci">float htu21d_compute_partial_pressure(float temperature)</div><div class="ttdoc">Calculates the Partial Pressure at ambient temperature, by using the ambient temperature read from th...</div><div class="ttdef"><b>Definition:</b> <a href="htu21d_8c_source.html#l00150">htu21d.c:150</a></div></div>
<div class="ttc" id="ahtu21d_8c_html_a837f184fd5f7cd215a73fde29517e680"><div class="ttname"><a href="htu21d_8c.html#a837f184fd5f7cd215a73fde29517e680">HTU21_CONSTANT_A</a></div><div class="ttdeci">#define HTU21_CONSTANT_A</div><div class="ttdoc">Constant A used in Partial Pressure from Ambient Temperature formula.</div><div class="ttdef"><b>Definition:</b> <a href="htu21d_8c_source.html#l00018">htu21d.c:18</a></div></div>
<div class="ttc" id="ahtu21d_8c_html_a9ab0f7858e0ae95aaeda107dc97b37fa"><div class="ttname"><a href="htu21d_8c.html#a9ab0f7858e0ae95aaeda107dc97b37fa">HTU21_CONSTANT_B</a></div><div class="ttdeci">#define HTU21_CONSTANT_B</div><div class="ttdoc">Constant B used in Partial Pressure from Ambient Temperature formula.</div><div class="ttdef"><b>Definition:</b> <a href="htu21d_8c_source.html#l00019">htu21d.c:19</a></div></div>
<div class="ttc" id="ahtu21d_8c_html_aa5e26d52ff76908c4b22baeebe83d017"><div class="ttname"><a href="htu21d_8c.html#aa5e26d52ff76908c4b22baeebe83d017">HTU21_CONSTANT_C</a></div><div class="ttdeci">#define HTU21_CONSTANT_C</div><div class="ttdoc">Constant C used in Partial Pressure from Ambient Temperature formula.</div><div class="ttdef"><b>Definition:</b> <a href="htu21d_8c_source.html#l00020">htu21d.c:20</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2e60229c5b94700ed68974681822f9e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e60229c5b94700ed68974681822f9e2">&#9670;&nbsp;</a></span>htu21d_compute_partial_pressure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float htu21d_compute_partial_pressure </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>temperature</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the Partial Pressure at ambient temperature, by using the ambient temperature read from the HTU21D sensor. </p>
<p>This function is really only used to calculate the dew point. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">temperature</td><td>Actual ambient temperature measured from sensor (degC). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the current Partial Pressure in mmHg at ambient temperature. </dd></dl>

<p class="definition">Definition at line <a class="el" href="htu21d_8c_source.html#l00150">150</a> of file <a class="el" href="htu21d_8c_source.html">htu21d.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;{</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">return</span> pow(10, <a class="code" href="htu21d_8c.html#a837f184fd5f7cd215a73fde29517e680">HTU21_CONSTANT_A</a> - <a class="code" href="htu21d_8c.html#a9ab0f7858e0ae95aaeda107dc97b37fa">HTU21_CONSTANT_B</a> / (temperature + <a class="code" href="htu21d_8c.html#aa5e26d52ff76908c4b22baeebe83d017">HTU21_CONSTANT_C</a>));</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9fa5f607e157a9212f40c0ed3188fc70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fa5f607e157a9212f40c0ed3188fc70">&#9670;&nbsp;</a></span>htu21d_get_resolution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t htu21d_get_resolution </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="htu21d_8c_source.html#l00185">185</a> of file <a class="el" href="htu21d_8c_source.html">htu21d.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;{</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    uint8_t reg_value = <a class="code" href="htu21d_8c.html#aa715a7b21d0b58494f0c882e528f6aea">htu21d_read_user_register</a>();</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">return</span> reg_value &amp; 0b10000001;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;}</div>
<div class="ttc" id="ahtu21d_8c_html_aa715a7b21d0b58494f0c882e528f6aea"><div class="ttname"><a href="htu21d_8c.html#aa715a7b21d0b58494f0c882e528f6aea">htu21d_read_user_register</a></div><div class="ttdeci">uint8_t htu21d_read_user_register()</div><div class="ttdef"><b>Definition:</b> <a href="htu21d_8c_source.html#l00241">htu21d.c:241</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad051dbd53437a44c5d767b481a2c3f86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad051dbd53437a44c5d767b481a2c3f86">&#9670;&nbsp;</a></span>htu21d_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int htu21d_init </td>
          <td>(</td>
          <td class="paramtype">i2c_port_t&#160;</td>
          <td class="paramname"><em>port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sda_pin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>scl_pin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gpio_pullup_t&#160;</td>
          <td class="paramname"><em>sda_internal_pullup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gpio_pullup_t&#160;</td>
          <td class="paramname"><em>scl_internal_pullup</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the HTU21D temperature/humidity sensor and the I2C bus. </p>
<p>I2C bus runs in master mode @ 100,000. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">port</td><td>I2C port number to use, can be #I2C_NUM_0 ~ (#I2C_NUM_MAX - 1). </td></tr>
    <tr><td class="paramname">sda_pin</td><td>The GPIO pin number to use for the I2C sda (data) signal. </td></tr>
    <tr><td class="paramname">scl_pin</td><td>The GPIO pin number to use for the I2C scl (clock) signal. </td></tr>
    <tr><td class="paramname">sda_internal_pullup</td><td>Internal GPIO pull mode for I2C sda signal. </td></tr>
    <tr><td class="paramname">scl_internal_pullup</td><td>Internal GPIO pull mode for I2C scl signal. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns <a class="el" href="htu21d_8h.html#a7911c90dfd18b9337f00936d7f96ca9e">HTU21D_ERR_OK</a> if I2C bus is initialized successfully and the HTU21D sensor is found. Returns <a class="el" href="htu21d_8h.html#a27eb002ff79d3b94e108b712b62c525a">HTU21D_ERR_CONFIG</a> if there is an error configuring the I2C bus. Returns <a class="el" href="htu21d_8h.html#ab4f0869343d989d108173d5626458311">HTU21D_ERR_INSTALL</a> if the I2C driver fails to install. Returns <a class="el" href="htu21d_8h.html#af222cbb03e16280f4002f69c112ebab6">HTU21D_ERR_NOTFOUND</a> if the HTU21D sensor could not be found on the I2C bus. </dd></dl>

<p class="definition">Definition at line <a class="el" href="htu21d_8c_source.html#l00041">41</a> of file <a class="el" href="htu21d_8c_source.html">htu21d.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;{</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    esp_err_t ret;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    _port = port;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">// setup i2c controller</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    i2c_config_t conf = {0};</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    conf.mode = I2C_MODE_MASTER;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    conf.sda_io_num = sda_pin;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    conf.scl_io_num = scl_pin;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    conf.sda_pullup_en = sda_internal_pullup;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    conf.scl_pullup_en = scl_internal_pullup;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    conf.master.clk_speed = 100000;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    ret = i2c_param_config(port, &amp;conf);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordflow">if</span> (ret != ESP_OK) {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        ESP_LOGE(TAG, <span class="stringliteral">&quot;Failed to configure I2C (port %d, sda_pin %d, scl_pin %d): %s&quot;</span>, port, sda_pin, scl_pin, esp_err_to_name(ret));</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="htu21d_8h.html#a27eb002ff79d3b94e108b712b62c525a">HTU21D_ERR_CONFIG</a>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    }</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="comment">// install the driver</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    ret = i2c_driver_install(port, I2C_MODE_MASTER, 0, 0, 0);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">if</span> (ret != ESP_OK) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        ESP_LOGE(TAG, <span class="stringliteral">&quot;Failed to install I2C driver: %s&quot;</span>, esp_err_to_name(ret));</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="htu21d_8h.html#ab4f0869343d989d108173d5626458311">HTU21D_ERR_INSTALL</a>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">// verify if a sensor is present</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    i2c_cmd_handle_t cmd = i2c_cmd_link_create();</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">if</span> (cmd == NULL) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        ESP_LOGE(TAG, <span class="stringliteral">&quot;Not enough dynamic memory&quot;</span>);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="htu21d_8h.html#aa95acb9cf1faf39a44a490e7b64fac2c">HTU21D_ERR_FAIL</a>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(i2c_master_start(cmd));</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(i2c_master_write_byte(</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                                      cmd, (<a class="code" href="htu21d_8h.html#a78632190979dac1c2ff5ccbf695a12f3">HTU21D_ADDR</a> &lt;&lt; 1) | I2C_MASTER_WRITE, <span class="keyword">true</span>));</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(i2c_master_stop(cmd));</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    ret = i2c_master_cmd_begin(port, cmd, 1000 / portTICK_PERIOD_MS);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">if</span> (ret != ESP_OK) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        ESP_LOGE(TAG, <span class="stringliteral">&quot;HTU21D sensor not found on bus: %s&quot;</span>, esp_err_to_name(ret));</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="htu21d_8h.html#af222cbb03e16280f4002f69c112ebab6">HTU21D_ERR_NOTFOUND</a>;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="htu21d_8h.html#a7911c90dfd18b9337f00936d7f96ca9e">HTU21D_ERR_OK</a>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;}</div>
<div class="ttc" id="ahtu21d_8h_html_a27eb002ff79d3b94e108b712b62c525a"><div class="ttname"><a href="htu21d_8h.html#a27eb002ff79d3b94e108b712b62c525a">HTU21D_ERR_CONFIG</a></div><div class="ttdeci">#define HTU21D_ERR_CONFIG</div><div class="ttdef"><b>Definition:</b> <a href="htu21d_8h_source.html#l00035">htu21d.h:35</a></div></div>
<div class="ttc" id="ahtu21d_8h_html_a78632190979dac1c2ff5ccbf695a12f3"><div class="ttname"><a href="htu21d_8h.html#a78632190979dac1c2ff5ccbf695a12f3">HTU21D_ADDR</a></div><div class="ttdeci">#define HTU21D_ADDR</div><div class="ttdoc">I2C address of the HTU21D sensor.</div><div class="ttdef"><b>Definition:</b> <a href="htu21d_8h_source.html#l00022">htu21d.h:22</a></div></div>
<div class="ttc" id="ahtu21d_8h_html_a7911c90dfd18b9337f00936d7f96ca9e"><div class="ttname"><a href="htu21d_8h.html#a7911c90dfd18b9337f00936d7f96ca9e">HTU21D_ERR_OK</a></div><div class="ttdeci">#define HTU21D_ERR_OK</div><div class="ttdef"><b>Definition:</b> <a href="htu21d_8h_source.html#l00034">htu21d.h:34</a></div></div>
<div class="ttc" id="ahtu21d_8h_html_aa95acb9cf1faf39a44a490e7b64fac2c"><div class="ttname"><a href="htu21d_8h.html#aa95acb9cf1faf39a44a490e7b64fac2c">HTU21D_ERR_FAIL</a></div><div class="ttdeci">#define HTU21D_ERR_FAIL</div><div class="ttdef"><b>Definition:</b> <a href="htu21d_8h_source.html#l00039">htu21d.h:39</a></div></div>
<div class="ttc" id="ahtu21d_8h_html_ab4f0869343d989d108173d5626458311"><div class="ttname"><a href="htu21d_8h.html#ab4f0869343d989d108173d5626458311">HTU21D_ERR_INSTALL</a></div><div class="ttdeci">#define HTU21D_ERR_INSTALL</div><div class="ttdef"><b>Definition:</b> <a href="htu21d_8h_source.html#l00036">htu21d.h:36</a></div></div>
<div class="ttc" id="ahtu21d_8h_html_af222cbb03e16280f4002f69c112ebab6"><div class="ttname"><a href="htu21d_8h.html#af222cbb03e16280f4002f69c112ebab6">HTU21D_ERR_NOTFOUND</a></div><div class="ttdeci">#define HTU21D_ERR_NOTFOUND</div><div class="ttdef"><b>Definition:</b> <a href="htu21d_8h_source.html#l00037">htu21d.h:37</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6a22e7b10c2373f78b6933a55bd8ff43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a22e7b10c2373f78b6933a55bd8ff43">&#9670;&nbsp;</a></span>htu21d_read_humidity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float htu21d_read_humidity </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read the relative humidity from the HTU21D sensor. </p>
<p>Relative Humidity is the ratio of the actual water vapor pressure in the air to the saturation water vapor pressure in the air at a specific temperature, expressed as a percentage.</p>
<p>In other words, relative humidity represents the amount of water vapor present in the air as a percentage of the total amount of water vapor the air can hold relative to temperature.</p>
<p>For example, if the relative humidity is at 20% at the ambient air temperature of 25°C, then the air currently holds 20% of the maximum amount of water vapor it can hold at 25°C.</p>
<p>If the ambient temperature increases, the air can hold more water vapor, and the relative humidity will decrease since the air can hold more water vapor.</p>
<h3><a class="anchor" id="autotoc_md7"></a>
Temperature Compensated Relative Humidity</h3>
<p>For greater accuracy, you can run the result of this function, and the current temperature, through the <a class="el" href="htu21d_8c.html#a2d814d0d12bf79f01257b7f50321b116" title="Computes the temperature compensated humidity.">htu21_compute_compensated_humidity</a> function, which will compensate for the effect that temperature has on humidity. </p><dl class="section return"><dt>Returns</dt><dd>Returns the relative humidity percentage % read from the HTU21D sensor. Returns <code>-999</code> if it fails to read the humidity from the sensor. </dd></dl>

<p class="definition">Definition at line <a class="el" href="htu21d_8c_source.html#l00130">130</a> of file <a class="el" href="htu21d_8c_source.html">htu21d.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;{</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">// get the raw value from the sensor</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    uint16_t raw_humidity = <a class="code" href="htu21d_8c.html#aae2cded128546fee5cc5cd9d0d1092ab">read_value</a>(<a class="code" href="htu21d_8h.html#a0659a6fc516c148c4f0cee547e56568b">TRIGGER_HUMD_MEASURE_NOHOLD</a>);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">if</span> (raw_humidity == 0) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keywordflow">return</span> -999;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">// return the real value, formula in datasheet</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordflow">return</span> (raw_humidity * 125.0 / 65536.0) - 6.0;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;}</div>
<div class="ttc" id="ahtu21d_8c_html_aae2cded128546fee5cc5cd9d0d1092ab"><div class="ttname"><a href="htu21d_8c.html#aae2cded128546fee5cc5cd9d0d1092ab">read_value</a></div><div class="ttdeci">uint16_t read_value(uint8_t command)</div><div class="ttdef"><b>Definition:</b> <a href="htu21d_8c_source.html#l00322">htu21d.c:322</a></div></div>
<div class="ttc" id="ahtu21d_8h_html_a0659a6fc516c148c4f0cee547e56568b"><div class="ttname"><a href="htu21d_8h.html#a0659a6fc516c148c4f0cee547e56568b">TRIGGER_HUMD_MEASURE_NOHOLD</a></div><div class="ttdeci">#define TRIGGER_HUMD_MEASURE_NOHOLD</div><div class="ttdef"><b>Definition:</b> <a href="htu21d_8h_source.html#l00028">htu21d.h:28</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a81b12a55ffcd34e96c8fce5028b180b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81b12a55ffcd34e96c8fce5028b180b3">&#9670;&nbsp;</a></span>htu21d_read_temperature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float htu21d_read_temperature </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read the temperature from the HTU21D sensor. </p>
<dl class="section return"><dt>Returns</dt><dd>Returns the temperature read from the HTU21D sensor in degrees Celsius. Returns <code>-999</code> if it fails to read the temperature from the sensor. </dd></dl>

<p class="definition">Definition at line <a class="el" href="htu21d_8c_source.html#l00091">91</a> of file <a class="el" href="htu21d_8c_source.html">htu21d.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;{</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="comment">// get the raw value from the sensor</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    uint16_t raw_temperature = <a class="code" href="htu21d_8c.html#aae2cded128546fee5cc5cd9d0d1092ab">read_value</a>(<a class="code" href="htu21d_8h.html#a275485ce3ecf6c76cc101a6219ddd0e0">TRIGGER_TEMP_MEASURE_NOHOLD</a>);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">if</span> (raw_temperature == 0) {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordflow">return</span> -999;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    }</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">// return the real value, formula in datasheet</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordflow">return</span> (raw_temperature * 175.72 / 65536.0) - 46.85;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;}</div>
<div class="ttc" id="ahtu21d_8h_html_a275485ce3ecf6c76cc101a6219ddd0e0"><div class="ttname"><a href="htu21d_8h.html#a275485ce3ecf6c76cc101a6219ddd0e0">TRIGGER_TEMP_MEASURE_NOHOLD</a></div><div class="ttdeci">#define TRIGGER_TEMP_MEASURE_NOHOLD</div><div class="ttdef"><b>Definition:</b> <a href="htu21d_8h_source.html#l00027">htu21d.h:27</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa715a7b21d0b58494f0c882e528f6aea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa715a7b21d0b58494f0c882e528f6aea">&#9670;&nbsp;</a></span>htu21d_read_user_register()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t htu21d_read_user_register </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="htu21d_8c_source.html#l00241">241</a> of file <a class="el" href="htu21d_8c_source.html">htu21d.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;{</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    esp_err_t ret;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">// send the command</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    i2c_cmd_handle_t cmd = i2c_cmd_link_create();</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">if</span> (cmd == NULL) {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        ESP_LOGE(TAG, <span class="stringliteral">&quot;Not enough dynamic memory&quot;</span>);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(i2c_master_start(cmd));</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(i2c_master_write_byte(</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                                      cmd, (<a class="code" href="htu21d_8h.html#a78632190979dac1c2ff5ccbf695a12f3">HTU21D_ADDR</a> &lt;&lt; 1) | I2C_MASTER_WRITE, <span class="keyword">true</span>));</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(i2c_master_write_byte(cmd, <a class="code" href="htu21d_8h.html#ac8f29e611d6f87ee93d909b98a4db95d">READ_USER_REG</a>, <span class="keyword">true</span>));</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(i2c_master_stop(cmd));</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    ret = i2c_master_cmd_begin(_port, cmd, 1000 / portTICK_PERIOD_MS);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(ret);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    i2c_cmd_link_delete(cmd);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">if</span> (ret != ESP_OK) {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    }</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">// receive the answer</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    uint8_t reg_value;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    cmd = i2c_cmd_link_create();</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordflow">if</span> (cmd == NULL) {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        ESP_LOGE(TAG, <span class="stringliteral">&quot;Not enough dynamic memory&quot;</span>);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(i2c_master_start(cmd));</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(i2c_master_write_byte(</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                                      cmd, (<a class="code" href="htu21d_8h.html#a78632190979dac1c2ff5ccbf695a12f3">HTU21D_ADDR</a> &lt;&lt; 1) | I2C_MASTER_READ, <span class="keyword">true</span>));</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(i2c_master_read_byte(cmd, &amp;reg_value, 0x01));</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(i2c_master_stop(cmd));</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    ret = i2c_master_cmd_begin(_port, cmd, 1000 / portTICK_PERIOD_MS);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(ret);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    i2c_cmd_link_delete(cmd);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">if</span> (ret != ESP_OK) {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">return</span> reg_value;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;}</div>
<div class="ttc" id="ahtu21d_8h_html_ac8f29e611d6f87ee93d909b98a4db95d"><div class="ttname"><a href="htu21d_8h.html#ac8f29e611d6f87ee93d909b98a4db95d">READ_USER_REG</a></div><div class="ttdeci">#define READ_USER_REG</div><div class="ttdef"><b>Definition:</b> <a href="htu21d_8h_source.html#l00030">htu21d.h:30</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a435949c4c13de07e37ee0775279f05ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a435949c4c13de07e37ee0775279f05ca">&#9670;&nbsp;</a></span>htu21d_set_resolution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int htu21d_set_resolution </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>resolution</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="htu21d_8c_source.html#l00191">191</a> of file <a class="el" href="htu21d_8c_source.html">htu21d.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;{</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">// get the actual resolution</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    uint8_t reg_value = <a class="code" href="htu21d_8c.html#aa715a7b21d0b58494f0c882e528f6aea">htu21d_read_user_register</a>();</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    reg_value &amp;= 0b10000001;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">// update the register value with the new resolution</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    resolution &amp;= 0b10000001;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    reg_value |= resolution;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="htu21d_8c.html#a0d2e44ed88189e54d38d5b67c992cd26">htu21d_write_user_register</a>(reg_value);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;}</div>
<div class="ttc" id="ahtu21d_8c_html_a0d2e44ed88189e54d38d5b67c992cd26"><div class="ttname"><a href="htu21d_8c.html#a0d2e44ed88189e54d38d5b67c992cd26">htu21d_write_user_register</a></div><div class="ttdeci">int htu21d_write_user_register(uint8_t value)</div><div class="ttdef"><b>Definition:</b> <a href="htu21d_8c_source.html#l00285">htu21d.c:285</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaa3123a7b394609dbe9b1353f7f39211"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa3123a7b394609dbe9b1353f7f39211">&#9670;&nbsp;</a></span>htu21d_soft_reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int htu21d_soft_reset </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="htu21d_8c_source.html#l00205">205</a> of file <a class="el" href="htu21d_8c_source.html">htu21d.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;{</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    esp_err_t ret;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">// send the command</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    i2c_cmd_handle_t cmd = i2c_cmd_link_create();</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">if</span> (cmd == NULL) {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        ESP_LOGE(TAG, <span class="stringliteral">&quot;Not enough dynamic memory&quot;</span>);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="htu21d_8h.html#aa95acb9cf1faf39a44a490e7b64fac2c">HTU21D_ERR_FAIL</a>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(i2c_master_start(cmd));</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(i2c_master_write_byte(</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                                      cmd, (<a class="code" href="htu21d_8h.html#a78632190979dac1c2ff5ccbf695a12f3">HTU21D_ADDR</a> &lt;&lt; 1) | I2C_MASTER_WRITE, <span class="keyword">true</span>));</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(i2c_master_write_byte(cmd, <a class="code" href="htu21d_8h.html#a74625341a79e3484830c401d8947443c">SOFT_RESET</a>, <span class="keyword">true</span>));</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(i2c_master_stop(cmd));</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    ret = i2c_master_cmd_begin(_port, cmd, 1000 / portTICK_PERIOD_MS);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(ret);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    i2c_cmd_link_delete(cmd);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">switch</span> (ret) {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">case</span> ESP_ERR_INVALID_ARG:</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="htu21d_8h.html#ac9e11f3b8ca87d55809c03056eb905ab">HTU21D_ERR_INVALID_ARG</a>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">case</span> ESP_FAIL:</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="htu21d_8h.html#aa95acb9cf1faf39a44a490e7b64fac2c">HTU21D_ERR_FAIL</a>;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">case</span> ESP_ERR_INVALID_STATE:</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="htu21d_8h.html#a1d25d2985d46199e043390a8194cd4d2">HTU21D_ERR_INVALID_STATE</a>;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">case</span> ESP_ERR_TIMEOUT:</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="htu21d_8h.html#a847a119565ed8c573ef15a6492caf2a7">HTU21D_ERR_TIMEOUT</a>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="htu21d_8h.html#a7911c90dfd18b9337f00936d7f96ca9e">HTU21D_ERR_OK</a>;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;}</div>
<div class="ttc" id="ahtu21d_8h_html_a1d25d2985d46199e043390a8194cd4d2"><div class="ttname"><a href="htu21d_8h.html#a1d25d2985d46199e043390a8194cd4d2">HTU21D_ERR_INVALID_STATE</a></div><div class="ttdeci">#define HTU21D_ERR_INVALID_STATE</div><div class="ttdef"><b>Definition:</b> <a href="htu21d_8h_source.html#l00040">htu21d.h:40</a></div></div>
<div class="ttc" id="ahtu21d_8h_html_a74625341a79e3484830c401d8947443c"><div class="ttname"><a href="htu21d_8h.html#a74625341a79e3484830c401d8947443c">SOFT_RESET</a></div><div class="ttdeci">#define SOFT_RESET</div><div class="ttdef"><b>Definition:</b> <a href="htu21d_8h_source.html#l00031">htu21d.h:31</a></div></div>
<div class="ttc" id="ahtu21d_8h_html_a847a119565ed8c573ef15a6492caf2a7"><div class="ttname"><a href="htu21d_8h.html#a847a119565ed8c573ef15a6492caf2a7">HTU21D_ERR_TIMEOUT</a></div><div class="ttdeci">#define HTU21D_ERR_TIMEOUT</div><div class="ttdef"><b>Definition:</b> <a href="htu21d_8h_source.html#l00041">htu21d.h:41</a></div></div>
<div class="ttc" id="ahtu21d_8h_html_ac9e11f3b8ca87d55809c03056eb905ab"><div class="ttname"><a href="htu21d_8h.html#ac9e11f3b8ca87d55809c03056eb905ab">HTU21D_ERR_INVALID_ARG</a></div><div class="ttdeci">#define HTU21D_ERR_INVALID_ARG</div><div class="ttdef"><b>Definition:</b> <a href="htu21d_8h_source.html#l00038">htu21d.h:38</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0d2e44ed88189e54d38d5b67c992cd26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d2e44ed88189e54d38d5b67c992cd26">&#9670;&nbsp;</a></span>htu21d_write_user_register()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int htu21d_write_user_register </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="htu21d_8c_source.html#l00285">285</a> of file <a class="el" href="htu21d_8c_source.html">htu21d.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;{</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    esp_err_t ret;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">// send the command</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    i2c_cmd_handle_t cmd = i2c_cmd_link_create();</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">if</span> (cmd == NULL) {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        ESP_LOGE(TAG, <span class="stringliteral">&quot;Not enough dynamic memory&quot;</span>);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="htu21d_8h.html#aa95acb9cf1faf39a44a490e7b64fac2c">HTU21D_ERR_FAIL</a>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(i2c_master_start(cmd));</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        i2c_master_write_byte(cmd, (<a class="code" href="htu21d_8h.html#a78632190979dac1c2ff5ccbf695a12f3">HTU21D_ADDR</a> &lt;&lt; 1) | I2C_MASTER_WRITE, <span class="keyword">true</span>));</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(i2c_master_write_byte(cmd, <a class="code" href="htu21d_8h.html#a55ed60e8a2df61a067ef0fb42f79f6b2">WRITE_USER_REG</a>, <span class="keyword">true</span>));</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(i2c_master_write_byte(cmd, value, <span class="keyword">true</span>));</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(i2c_master_stop(cmd));</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    ret = i2c_master_cmd_begin(_port, cmd, 1000 / portTICK_PERIOD_MS);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(ret);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    i2c_cmd_link_delete(cmd);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">switch</span> (ret) {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordflow">case</span> ESP_ERR_INVALID_ARG:</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="htu21d_8h.html#ac9e11f3b8ca87d55809c03056eb905ab">HTU21D_ERR_INVALID_ARG</a>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">case</span> ESP_FAIL:</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="htu21d_8h.html#aa95acb9cf1faf39a44a490e7b64fac2c">HTU21D_ERR_FAIL</a>;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">case</span> ESP_ERR_INVALID_STATE:</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="htu21d_8h.html#a1d25d2985d46199e043390a8194cd4d2">HTU21D_ERR_INVALID_STATE</a>;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordflow">case</span> ESP_ERR_TIMEOUT:</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="htu21d_8h.html#a847a119565ed8c573ef15a6492caf2a7">HTU21D_ERR_TIMEOUT</a>;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="htu21d_8h.html#a7911c90dfd18b9337f00936d7f96ca9e">HTU21D_ERR_OK</a>;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;}</div>
<div class="ttc" id="ahtu21d_8h_html_a55ed60e8a2df61a067ef0fb42f79f6b2"><div class="ttname"><a href="htu21d_8h.html#a55ed60e8a2df61a067ef0fb42f79f6b2">WRITE_USER_REG</a></div><div class="ttdeci">#define WRITE_USER_REG</div><div class="ttdef"><b>Definition:</b> <a href="htu21d_8h_source.html#l00029">htu21d.h:29</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a59a8faa300ba356f970ca9e961381ac2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59a8faa300ba356f970ca9e961381ac2">&#9670;&nbsp;</a></span>is_crc_valid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool is_crc_valid </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>crc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="htu21d_8c_source.html#l00376">376</a> of file <a class="el" href="htu21d_8c_source.html">htu21d.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;{</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="comment">// line the bits representing the input in a row (first data, then crc)</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    uint32_t row = (uint32_t)value &lt;&lt; 8;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    row |= crc;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="comment">// polynomial = x^8 + x^5 + x^4 + 1</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="comment">// padded with zeroes corresponding to the bit length of the CRC</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    uint32_t divisor = (uint32_t)0x988000;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0 ; i &lt; 16 ; i++) {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="comment">// if the input bit above the leftmost divisor bit is 1,</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="comment">// the divisor is XORed into the input</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keywordflow">if</span> (row &amp; (uint32_t)1 &lt;&lt; (23 - i)) {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            row ^= divisor;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        }</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="comment">// the divisor is then shifted one bit to the right</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        divisor &gt;&gt;= 1;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    }</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="comment">// the remainder should equal zero if there are no detectable errors</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordflow">return</span> (row == 0);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aae2cded128546fee5cc5cd9d0d1092ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae2cded128546fee5cc5cd9d0d1092ab">&#9670;&nbsp;</a></span>read_value()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t read_value </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>command</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="htu21d_8c_source.html#l00322">322</a> of file <a class="el" href="htu21d_8c_source.html">htu21d.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;{</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    esp_err_t ret;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">// send the command</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    i2c_cmd_handle_t cmd = i2c_cmd_link_create();</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">if</span> (cmd == NULL) {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        ESP_LOGE(TAG, <span class="stringliteral">&quot;Not enough dynamic memory&quot;</span>);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(i2c_master_start(cmd));</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        i2c_master_write_byte(cmd, (<a class="code" href="htu21d_8h.html#a78632190979dac1c2ff5ccbf695a12f3">HTU21D_ADDR</a> &lt;&lt; 1) | I2C_MASTER_WRITE, <span class="keyword">true</span>));</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(i2c_master_write_byte(cmd, command, <span class="keyword">true</span>));</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(i2c_master_stop(cmd));</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    ret = i2c_master_cmd_begin(_port, cmd, 1000 / portTICK_PERIOD_MS);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(ret);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    i2c_cmd_link_delete(cmd);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">if</span> (ret != ESP_OK) {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    }</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">// wait for the sensor (50ms)</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    vTaskDelay(50 / portTICK_PERIOD_MS);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="comment">// receive the answer</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    uint8_t msb, lsb, crc;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    cmd = i2c_cmd_link_create();</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">if</span> (cmd == NULL) {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        ESP_LOGE(TAG, <span class="stringliteral">&quot;Not enough dynamic memory&quot;</span>);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(i2c_master_start(cmd));</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        i2c_master_write_byte(cmd, (<a class="code" href="htu21d_8h.html#a78632190979dac1c2ff5ccbf695a12f3">HTU21D_ADDR</a> &lt;&lt; 1) | I2C_MASTER_READ, <span class="keyword">true</span>));</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(i2c_master_read_byte(cmd, &amp;msb, 0x00));</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(i2c_master_read_byte(cmd, &amp;lsb, 0x00));</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(i2c_master_read_byte(cmd, &amp;crc, 0x01));</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(i2c_master_stop(cmd));</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    ret = i2c_master_cmd_begin(_port, cmd, 1000 / portTICK_PERIOD_MS);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    ESP_ERROR_CHECK_WITHOUT_ABORT(ret);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    i2c_cmd_link_delete(cmd);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordflow">if</span> (ret != ESP_OK) {</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    uint16_t raw_value = ((uint16_t) msb &lt;&lt; 8) | (uint16_t) lsb;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="htu21d_8c.html#a59a8faa300ba356f970ca9e961381ac2">is_crc_valid</a>(raw_value, crc)) {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        ESP_LOGE(TAG, <span class="stringliteral">&quot;CRC is invalid.&quot;</span>);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    }</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordflow">return</span> raw_value &amp; 0xFFFC;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;}</div>
<div class="ttc" id="ahtu21d_8c_html_a59a8faa300ba356f970ca9e961381ac2"><div class="ttname"><a href="htu21d_8c.html#a59a8faa300ba356f970ca9e961381ac2">is_crc_valid</a></div><div class="ttdeci">bool is_crc_valid(uint16_t value, uint8_t crc)</div><div class="ttdef"><b>Definition:</b> <a href="htu21d_8c_source.html#l00376">htu21d.c:376</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="htu21d_8c.html">htu21d.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
